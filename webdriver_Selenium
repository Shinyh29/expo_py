import pandas as pd
from selenium import webdriver
from selenium.webdriver.common.action_chains import ActionChains
#from selenium.webdriver.support.ui import WebDriverWait
#from selenium.webdriver.support import expected_conditions as EC
#from selenium.webdriver.common.by import By
#from selenium.common.exceptions import ElementNotVisibleException
driver = webdriver.Chrome(executable_path='C:\\chromedriver\\chromedriver.exe')
url="http://www.seibro.or.kr/websquare/control.jsp?w2xPath=/IPORTAL/user/company/BIP_CNTS01045V.xml&menuNo=284"

import time
driver.get(url)
time.sleep(4)
t_option = driver.find_element_by_xpath('//*[@id="sd1_selectbox1_input_0"]/option[2]') #기간선택옵션
t_option.click()

ActionChains(driver).move_to_element(driver.find_elements_by_class_name('w2inputCalendar_col_input')[0]).click().click().send_keys('20190201').perform()
ActionChains(driver).move_to_element(driver.find_elements_by_class_name('w2inputCalendar_col_input')[1]).click().click().send_keys('20190301').perform()
## find_elements 로 다 찾아서 [0]첫번쨰것. 서치시작~ 다음것[1] 조회끗날 

driver.find_element_by_xpath('//*[@id="image2"]').click() # 조회

time.sleep(4)


dfs = pd.DataFrame()
def frame_sele(ppath):
    
    df = pd.read_html(driver.page_source)
    dfs.append(df)
    print(ppath)
    print(df)
    time.sleep(2)
    driver.find_element_by_xpath(ppath).click()
    #ActionChains(driver).move_to_element(driver.find_element_by_class_name('w2inputCalendar_col_input')).click().click().send_keys('20190301').perform()
    #더블클릭, 달력날짜값전달가능
    
    
    
    
    
    
    
    
for i in range(1, 15):
    print("waiting___...%d" % i)
    ppath = '//*[@id="cntsPaging01_page_%d"]' % i
    try:
        frame_sele(ppath)
        print(frame_sele(ppath))
        time.sleep(15)
    except Exception as ex:
        print(ex)
        time.sleep(15)
        frame_sele(ppath)    
                    
                
       
print(dfs)
