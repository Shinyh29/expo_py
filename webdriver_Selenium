import pandas as pd
from selenium import webdriver
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from selenium.webdriver.common.by import By
from selenium.common.exceptions import ElementNotVisibleException
driver = webdriver.Chrome(executable_path='C:\\chromedriver\\chromedriver.exe')
url="http://www.seibro.or.kr/websquare/control.jsp?w2xPath=/IPORTAL/user/company/BIP_CNTS01045V.xml&menuNo=284"

import time
driver.get(url)
time.sleep(4)
t_option = driver.find_element_by_xpath('//*[@id="sd1_selectbox1_input_0"]/option[2]') #기간선택옵션
t_option.click()
driver.find_element_by_xpath('//*[@id="image2"]').click() # 조회

time.sleep(4)


dfs = pd.DataFrame()
def frame_sele(ppath):
    driver.find_element_by_xpath(ppath).click()
    time.wait(3)
    df = pd.read_html(driver.page_source)
    dfs.append(df)
    print(ppath)
    print(df)
    return i
      
    
for i in range(1, 15):
        
        while 1:
            try:
                WebDriverWait(driver, 3).until(EC.element_to_be_clickable((By.XPATH,'//*[@id="image2"]' )))
                print("waiting___...")
                time.sleep(2)

            except ElementNotVisibleException:
                ppath = '//*[@id="cntsPaging01_page_%d"]' % i                
                frame_sele()
                if frame_sele() >=4:
                    break
                    
                
       
print(dfs)
